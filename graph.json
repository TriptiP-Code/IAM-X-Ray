{
  "nodes": [
    {
      "id": "practice-user",
      "type": "user",
      "risky": false,
      "meta": {
        "UserName": "practice-user",
        "Arn": "arn:aws:iam::851725195108:user/practice-user",
        "CreateDate": "2025-09-05T08:20:31+00:00",
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      }
    },
    {
      "id": "Developer",
      "type": "group",
      "risky": false,
      "meta": {
        "GroupName": "Developer",
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      }
    },
    {
      "id": "AWSServiceRoleForAccessAnalyzer",
      "type": "role",
      "risky": false,
      "meta": {
        "RoleName": "AWSServiceRoleForAccessAnalyzer",
        "Arn": "arn:aws:iam::851725195108:role/aws-service-role/access-analyzer.amazonaws.com/AWSServiceRoleForAccessAnalyzer",
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "access-analyzer.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "AssumePolicyRisk": false,
        "AssumePolicyRiskActions": [
          "Trust:*"
        ],
        "AssumePolicyRiskScore": 0,
        "AssumePolicyFindings": [],
        "PrincipalsInfo": [
          {
            "type": "service",
            "value": "access-analyzer.amazonaws.com"
          }
        ],
        "AttachedPolicies": [],
        "InlinePolicies": [],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 0
    },
    {
      "id": "PRINC:access-analyzer.amazonaws.com",
      "type": "principal",
      "risky": false,
      "meta": {
        "principal": "access-analyzer.amazonaws.com",
        "principal_type": "service"
      }
    },
    {
      "id": "AWSServiceRoleForAmazonGuardDuty",
      "type": "role",
      "risky": false,
      "meta": {
        "RoleName": "AWSServiceRoleForAmazonGuardDuty",
        "Arn": "arn:aws:iam::851725195108:role/aws-service-role/guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDuty",
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "guardduty.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "AssumePolicyRisk": false,
        "AssumePolicyRiskActions": [
          "Trust:*"
        ],
        "AssumePolicyRiskScore": 0,
        "AssumePolicyFindings": [],
        "PrincipalsInfo": [
          {
            "type": "service",
            "value": "guardduty.amazonaws.com"
          }
        ],
        "AttachedPolicies": [],
        "InlinePolicies": [],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 0
    },
    {
      "id": "PRINC:guardduty.amazonaws.com",
      "type": "principal",
      "risky": false,
      "meta": {
        "principal": "guardduty.amazonaws.com",
        "principal_type": "service"
      }
    },
    {
      "id": "AWSServiceRoleForAmazonGuardDutyMalwareProtection",
      "type": "role",
      "risky": false,
      "meta": {
        "RoleName": "AWSServiceRoleForAmazonGuardDutyMalwareProtection",
        "Arn": "arn:aws:iam::851725195108:role/aws-service-role/malware-protection.guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDutyMalwareProtection",
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "malware-protection.guardduty.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "AssumePolicyRisk": false,
        "AssumePolicyRiskActions": [
          "Trust:*"
        ],
        "AssumePolicyRiskScore": 0,
        "AssumePolicyFindings": [],
        "PrincipalsInfo": [
          {
            "type": "service",
            "value": "malware-protection.guardduty.amazonaws.com"
          }
        ],
        "AttachedPolicies": [],
        "InlinePolicies": [],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 0
    },
    {
      "id": "PRINC:malware-protection.guardduty.amazonaws.com",
      "type": "principal",
      "risky": false,
      "meta": {
        "principal": "malware-protection.guardduty.amazonaws.com",
        "principal_type": "service"
      }
    },
    {
      "id": "AWSServiceRoleForAmazonSSM",
      "type": "role",
      "risky": false,
      "meta": {
        "RoleName": "AWSServiceRoleForAmazonSSM",
        "Arn": "arn:aws:iam::851725195108:role/aws-service-role/ssm.amazonaws.com/AWSServiceRoleForAmazonSSM",
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "ssm.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "AssumePolicyRisk": false,
        "AssumePolicyRiskActions": [
          "Trust:*"
        ],
        "AssumePolicyRiskScore": 0,
        "AssumePolicyFindings": [],
        "PrincipalsInfo": [
          {
            "type": "service",
            "value": "ssm.amazonaws.com"
          }
        ],
        "AttachedPolicies": [],
        "InlinePolicies": [],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 0
    },
    {
      "id": "PRINC:ssm.amazonaws.com",
      "type": "principal",
      "risky": false,
      "meta": {
        "principal": "ssm.amazonaws.com",
        "principal_type": "service"
      }
    },
    {
      "id": "AWSServiceRoleForApplicationAutoScaling_DynamoDBTable",
      "type": "role",
      "risky": false,
      "meta": {
        "RoleName": "AWSServiceRoleForApplicationAutoScaling_DynamoDBTable",
        "Arn": "arn:aws:iam::851725195108:role/aws-service-role/dynamodb.application-autoscaling.amazonaws.com/AWSServiceRoleForApplicationAutoScaling_DynamoDBTable",
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "dynamodb.application-autoscaling.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "AssumePolicyRisk": false,
        "AssumePolicyRiskActions": [
          "Trust:*"
        ],
        "AssumePolicyRiskScore": 0,
        "AssumePolicyFindings": [],
        "PrincipalsInfo": [
          {
            "type": "service",
            "value": "dynamodb.application-autoscaling.amazonaws.com"
          }
        ],
        "AttachedPolicies": [],
        "InlinePolicies": [],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 0
    },
    {
      "id": "PRINC:dynamodb.application-autoscaling.amazonaws.com",
      "type": "principal",
      "risky": false,
      "meta": {
        "principal": "dynamodb.application-autoscaling.amazonaws.com",
        "principal_type": "service"
      }
    },
    {
      "id": "AWSServiceRoleForOrganizations",
      "type": "role",
      "risky": false,
      "meta": {
        "RoleName": "AWSServiceRoleForOrganizations",
        "Arn": "arn:aws:iam::851725195108:role/aws-service-role/organizations.amazonaws.com/AWSServiceRoleForOrganizations",
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "organizations.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "AssumePolicyRisk": false,
        "AssumePolicyRiskActions": [
          "Trust:*"
        ],
        "AssumePolicyRiskScore": 0,
        "AssumePolicyFindings": [],
        "PrincipalsInfo": [
          {
            "type": "service",
            "value": "organizations.amazonaws.com"
          }
        ],
        "AttachedPolicies": [],
        "InlinePolicies": [],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 0
    },
    {
      "id": "PRINC:organizations.amazonaws.com",
      "type": "principal",
      "risky": false,
      "meta": {
        "principal": "organizations.amazonaws.com",
        "principal_type": "service"
      }
    },
    {
      "id": "AWSServiceRoleForSecurityHub",
      "type": "role",
      "risky": false,
      "meta": {
        "RoleName": "AWSServiceRoleForSecurityHub",
        "Arn": "arn:aws:iam::851725195108:role/aws-service-role/securityhub.amazonaws.com/AWSServiceRoleForSecurityHub",
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "securityhub.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "AssumePolicyRisk": false,
        "AssumePolicyRiskActions": [
          "Trust:*"
        ],
        "AssumePolicyRiskScore": 0,
        "AssumePolicyFindings": [],
        "PrincipalsInfo": [
          {
            "type": "service",
            "value": "securityhub.amazonaws.com"
          }
        ],
        "AttachedPolicies": [],
        "InlinePolicies": [],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 0
    },
    {
      "id": "PRINC:securityhub.amazonaws.com",
      "type": "principal",
      "risky": false,
      "meta": {
        "principal": "securityhub.amazonaws.com",
        "principal_type": "service"
      }
    },
    {
      "id": "AWSServiceRoleForSSO",
      "type": "role",
      "risky": false,
      "meta": {
        "RoleName": "AWSServiceRoleForSSO",
        "Arn": "arn:aws:iam::851725195108:role/aws-service-role/sso.amazonaws.com/AWSServiceRoleForSSO",
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "sso.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "AssumePolicyRisk": false,
        "AssumePolicyRiskActions": [
          "Trust:*"
        ],
        "AssumePolicyRiskScore": 0,
        "AssumePolicyFindings": [],
        "PrincipalsInfo": [
          {
            "type": "service",
            "value": "sso.amazonaws.com"
          }
        ],
        "AttachedPolicies": [],
        "InlinePolicies": [],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 0
    },
    {
      "id": "PRINC:sso.amazonaws.com",
      "type": "principal",
      "risky": false,
      "meta": {
        "principal": "sso.amazonaws.com",
        "principal_type": "service"
      }
    },
    {
      "id": "AWSServiceRoleForSupport",
      "type": "role",
      "risky": false,
      "meta": {
        "RoleName": "AWSServiceRoleForSupport",
        "Arn": "arn:aws:iam::851725195108:role/aws-service-role/support.amazonaws.com/AWSServiceRoleForSupport",
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "support.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "AssumePolicyRisk": false,
        "AssumePolicyRiskActions": [
          "Trust:*"
        ],
        "AssumePolicyRiskScore": 0,
        "AssumePolicyFindings": [],
        "PrincipalsInfo": [
          {
            "type": "service",
            "value": "support.amazonaws.com"
          }
        ],
        "AttachedPolicies": [],
        "InlinePolicies": [],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 0
    },
    {
      "id": "PRINC:support.amazonaws.com",
      "type": "principal",
      "risky": false,
      "meta": {
        "principal": "support.amazonaws.com",
        "principal_type": "service"
      }
    },
    {
      "id": "AWSServiceRoleForTrustedAdvisor",
      "type": "role",
      "risky": false,
      "meta": {
        "RoleName": "AWSServiceRoleForTrustedAdvisor",
        "Arn": "arn:aws:iam::851725195108:role/aws-service-role/trustedadvisor.amazonaws.com/AWSServiceRoleForTrustedAdvisor",
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "trustedadvisor.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "AssumePolicyRisk": false,
        "AssumePolicyRiskActions": [
          "Trust:*"
        ],
        "AssumePolicyRiskScore": 0,
        "AssumePolicyFindings": [],
        "PrincipalsInfo": [
          {
            "type": "service",
            "value": "trustedadvisor.amazonaws.com"
          }
        ],
        "AttachedPolicies": [],
        "InlinePolicies": [],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 0
    },
    {
      "id": "PRINC:trustedadvisor.amazonaws.com",
      "type": "principal",
      "risky": false,
      "meta": {
        "principal": "trustedadvisor.amazonaws.com",
        "principal_type": "service"
      }
    },
    {
      "id": "CloudTrailIdentityPolicy",
      "type": "policy",
      "risky": true,
      "meta": {
        "PolicyName": "CloudTrailIdentityPolicy",
        "Arn": "arn:aws:iam::851725195108:policy/CloudTrailIdentityPolicy",
        "Document": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Sid": "AllowCloudTrailManagement",
              "Effect": "Allow",
              "Action": [
                "cloudtrail:CreateTrail",
                "cloudtrail:UpdateTrail",
                "cloudtrail:DeleteTrail",
                "cloudtrail:StartLogging",
                "cloudtrail:StopLogging",
                "cloudtrail:GetTrailStatus",
                "cloudtrail:ListTrails",
                "cloudtrail:DescribeTrails",
                "cloudtrail:LookupEvents"
              ],
              "Resource": "*"
            },
            {
              "Sid": "AllowS3PermissionsForCloudTrail",
              "Effect": "Allow",
              "Action": [
                "s3:GetBucketAcl",
                "s3:PutBucketAcl",
                "s3:GetBucketPolicy",
                "s3:PutBucketPolicy",
                "s3:PutObject"
              ],
              "Resource": [
                "arn:aws:s3:::myorgtrail1",
                "arn:aws:s3:::myorgtrail1/*"
              ]
            },
            {
              "Sid": "AllowAccessAnalyzerManagement",
              "Effect": "Allow",
              "Action": [
                "access-analyzer:CreateAnalyzer",
                "access-analyzer:ListAnalyzers",
                "access-analyzer:GetAnalyzer",
                "access-analyzer:DeleteAnalyzer",
                "access-analyzer:ListFindings",
                "access-analyzer:GetFinding",
                "access-analyzer:ApplyArchiveRule"
              ],
              "Resource": "*"
            }
          ]
        },
        "IsRisky": true,
        "RiskActions": [
          "Resource:*"
        ],
        "RiskScore": 8,
        "Findings": [
          {
            "code": "RESOURCE_WILDCARD",
            "severity": "high",
            "message": "Resource is '*' with Allow",
            "hint": "Scope resources to specific ARNs or tags",
            "path": "Statement[0]"
          },
          {
            "code": "RESOURCE_WILDCARD",
            "severity": "high",
            "message": "Resource is '*' with Allow",
            "hint": "Scope resources to specific ARNs or tags",
            "path": "Statement[2]"
          }
        ],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 8
    },
    {
      "id": "CrossAccountS3ReadRolePolicy",
      "type": "policy",
      "risky": false,
      "meta": {
        "PolicyName": "CrossAccountS3ReadRolePolicy",
        "Arn": "arn:aws:iam::851725195108:policy/CrossAccountS3ReadRolePolicy",
        "Document": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Action": [
                "s3:ListBucket"
              ],
              "Resource": "arn:aws:s3:::ec2-role-demo-blkice"
            },
            {
              "Effect": "Allow",
              "Action": [
                "s3:GetObject"
              ],
              "Resource": "arn:aws:s3:::ec2-role-demo-blkice/*"
            }
          ]
        },
        "IsRisky": false,
        "RiskActions": [],
        "RiskScore": 0,
        "Findings": [],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 0
    },
    {
      "id": "InternS3Boundary",
      "type": "policy",
      "risky": false,
      "meta": {
        "PolicyName": "InternS3Boundary",
        "Arn": "arn:aws:iam::851725195108:policy/InternS3Boundary",
        "Document": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Action": [
                "s3:GetObject",
                "s3:ListBucket"
              ],
              "Resource": "arn:aws:s3:::ec2-role-demo-blkice/*"
            }
          ]
        },
        "IsRisky": false,
        "RiskActions": [],
        "RiskScore": 0,
        "Findings": [],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 0
    },
    {
      "id": "MyCustomPolicy",
      "type": "policy",
      "risky": true,
      "meta": {
        "PolicyName": "MyCustomPolicy",
        "Arn": "arn:aws:iam::851725195108:policy/MyCustomPolicy",
        "Document": {
          "Statement": [
            {
              "Action": [
                "ec2:Describe*"
              ],
              "Effect": "Allow",
              "Resource": "*"
            }
          ],
          "Version": "2012-10-17"
        },
        "IsRisky": true,
        "RiskActions": [
          "Resource:*",
          "ec2:Describe*"
        ],
        "RiskScore": 8,
        "Findings": [
          {
            "code": "ACTION_WILDCARD",
            "severity": "high",
            "message": "Action uses '*' or wildcard pattern",
            "hint": "List explicit actions instead of '*'",
            "path": "Statement[0]"
          },
          {
            "code": "RESOURCE_WILDCARD",
            "severity": "high",
            "message": "Resource is '*' with Allow",
            "hint": "Scope resources to specific ARNs or tags",
            "path": "Statement[0]"
          }
        ],
        "ServiceLastUsed": {
          "services": [],
          "last_refreshed": null,
          "status": "skipped",
          "error": "Fast mode - usage data skipped"
        }
      },
      "risk_score": 8
    }
  ],
  "edges": [
    {
      "source": "PRINC:access-analyzer.amazonaws.com",
      "target": "AWSServiceRoleForAccessAnalyzer",
      "relation": "assumes"
    },
    {
      "source": "PRINC:guardduty.amazonaws.com",
      "target": "AWSServiceRoleForAmazonGuardDuty",
      "relation": "assumes"
    },
    {
      "source": "PRINC:malware-protection.guardduty.amazonaws.com",
      "target": "AWSServiceRoleForAmazonGuardDutyMalwareProtection",
      "relation": "assumes"
    },
    {
      "source": "PRINC:ssm.amazonaws.com",
      "target": "AWSServiceRoleForAmazonSSM",
      "relation": "assumes"
    },
    {
      "source": "PRINC:dynamodb.application-autoscaling.amazonaws.com",
      "target": "AWSServiceRoleForApplicationAutoScaling_DynamoDBTable",
      "relation": "assumes"
    },
    {
      "source": "PRINC:organizations.amazonaws.com",
      "target": "AWSServiceRoleForOrganizations",
      "relation": "assumes"
    },
    {
      "source": "PRINC:securityhub.amazonaws.com",
      "target": "AWSServiceRoleForSecurityHub",
      "relation": "assumes"
    },
    {
      "source": "PRINC:sso.amazonaws.com",
      "target": "AWSServiceRoleForSSO",
      "relation": "assumes"
    },
    {
      "source": "PRINC:support.amazonaws.com",
      "target": "AWSServiceRoleForSupport",
      "relation": "assumes"
    },
    {
      "source": "PRINC:trustedadvisor.amazonaws.com",
      "target": "AWSServiceRoleForTrustedAdvisor",
      "relation": "assumes"
    }
  ]
}